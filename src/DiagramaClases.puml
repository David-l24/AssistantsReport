@startuml Sistema de Gestión de Personal De Investigación - Actualizado

skinparam classAttributeIconSize 0

package "Logica.Entidades" {

    class Jefatura {
      - notificaciones: List<Notificacion>
      - nombres: String
      - apellidos: String
      - correo: String
      - cedula: String
      + revisarInformeDeActividades(int): InformeActividades
      + generarResumenSeguimiento(int): ResumenSeguimiento
      + aprobarReporte(Reporte): void
      + actualizarEstadoProyecto(Proyecto, EstadoProyecto): void
      + registrarProyecto(Proyecto): void
      + rechazarProyecto(Proyecto, EstadoProyecto): void
      + rechazarReporte(Reporte, String): void
      + cargarNotificaciones(): void
      + agregarNotificacion(Notificacion): void
      + revisarReportes(): List<Reporte>
    }

    class Director {
      - correo: String
      - notificaciones: List<Notificacion>
      - apellidos: String
      - nombres: String
      - cedula: String
      + revisarInformeDeActividades(int): InformeActividades
      + registrarPersonalDeInvestigacion(PersonalDeInvestigacion, int, LocalDate): void
      + rechazarInformeDeActividades(InformeActividades, String): void
      + cerrarReporte(Reporte): void
      + iniciarReporte(String, int): int
      + enviarReporte(Reporte): void
      + aprobarInformeDeActividades(InformeActividades): void
      + editarReporte(Reporte): void
      + agregarParticipacionAReporte(int, int): void
      + cargarNotificaciones(): void
      + registrarParticipacion(String, LocalDate): void
    }

    abstract class PersonalDeInvestigacion {
      - correo: String
      - nombres: String
      - informesActividades: List<InformeActividades>
      - notificaciones: List<Notificacion>
      - cedula: String
      - apellidos: String
      + cerrarInformeActividades(InformeActividades): void
      + agregarInforme(InformeActividades): void
      + editarInformeActividades(InformeActividades): void
      + iniciarInformeActividades(): InformeActividades
      - obtenerProyectoActual(): Proyecto
      + cargarNotificaciones(): void
    }

    abstract class Proyecto {
      - nombre: String
      - codigoProyecto: String
      - periodoInicio: PeriodoAcademico
      - estado: EstadoProyecto
      - numTecnicosPlanificados: int
      - numAsistentesPlanificados: int
      - duracionMeses: int
      - director: Director
      - numAyudantesPlanificados: int
      - personalDeInvestigacion: List<PersonalDeInvestigacion>
      + actualizarEstado(): void
      + agregarPersonal(PersonalDeInvestigacion): void

    }

    class ProyectoSemilla {
      + getTipoProyecto(): String
    }

    class ProyectoInterno {
      + getTipoProyecto(): String
    }

    class Reporte {
      - fechaInicio: LocalDate
      - fechaCierre: LocalDate
      - periodoAcademico: String
      - estado: EstadoReporte
      - participacionesIncluidas: List<Participacion>
      + cerrarYEnviar(): void
      + estaAtrasado(PeriodoAcademico): boolean
      + agregarParticipacion(Participacion): void
    }

    class PeriodoAcademico {
      - fechaMitad: LocalDate
      - fechaFin: LocalDate
      - codigo: String
      - fechaInicio: LocalDate

    }

    class Participacion {
      - fechaFin: LocalDate
      - personal: PersonalDeInvestigacion
      - estado: EstadoParticipacion
      - motivoRetiro: String
      - fechaInicio: LocalDate
      - fechaRetiro: LocalDate
      + esFinalizado(): boolean
      + esActivo(): boolean
      + registrarRetiro(String): void
      + calcularDuracionDias(): long
      + esRetirado(): boolean
    }

    class InformeActividades {
      - fechaRegistro: LocalDate
      - semanas: List<SemanaActividades>
      - proyecto: Proyecto
      - estado: EstadoInforme
      - personalDeInvestigacion: PersonalDeInvestigacion
      + agregarSemana(SemanaActividades): void
      + calcularHorasTotales(): double
      + enviarParaRevision(): void
      + devolverParaEdicion(): void
      + aprobar(): void
      + rechazar(String): void
    }

    class ResumenSeguimiento {
      - totalPlanificado: int
      - cantidadAyudantesRetirados: int
      - cumplePlanificacionGlobal: boolean
      - cantidadAsistentesActivos: int
      - cantidadAsistentesRegistrados: int
      - totalRegistrado: int
      - cantidadAyudantesPlanificados: int
      - cantidadAsistentesPlanificados: int
      - totalActivo: int
      - totalRetirado: int
      - cantidadTecnicosRegistrados: int
      - cantidadTecnicosRetirados: int
      - cantidadAsistentesRetirados: int
      - cantidadAyudantesRegistrados: int
      - cantidadAyudantesActivos: int
      - cantidadTecnicosActivos: int
      - cantidadTecnicosPlanificados: int
      + calcularTotales(): void
      + isCumplePlanificacionGlobal(): boolean
      + verificarCumplimiento(): boolean
    }

    class Notificacion {
      - contenido: String
      - fecha: LocalDateTime
      + toString(): String
    }

    class SemanaActividades {
      - fechas: Date[]
      - numeroSemana: int
      - actividadSemanal: String
      - horasSalida: Time[]
      - observaciones: String
      - horasInicio: Time[]
      + contarDiasTrabajados(): int
      + calcularHorasTotales(): double
    }

    class Asistente {
       + getTipo() : String
    }

    class Ayudante {
       + getTipo() : String
    }

    class Tecnico {
       + getTipo() : String
    }

    enum EstadoProyecto {
        EN_REVISION
        APROBADO
        NO_APROBADO
        FINALIZADO
    }

    enum EstadoReporte {
        APROBADO
        EN_EDICION
        CERRADO
        RECHAZADO
    }

    enum EstadoParticipacion {
        ACTIVO
        RETIRADO
        FINALIZADO
    }



}

' ============================================
' RELACIONES ENTRE ENTIDADES
' ============================================

' Proyecto y Director
Director --> Proyecto
Proyecto --> PeriodoAcademico

' Herencia Proyectos
ProyectoInterno --|> Proyecto
ProyectoSemilla --|> Proyecto

' Reporte
Proyecto --> Reporte
Reporte --> PeriodoAcademico
Reporte --> EstadoReporte
Reporte --> Participacion

' Resumen
Proyecto --> ResumenSeguimiento

' [NUEVO] Relacion Participacion -> Informe
' Una Participacion tiene muchos informes de actividades
PersonalDeInvestigacion --> InformeActividades
InformeActividades --> EstadoReporte

' Personal y Participacion
PersonalDeInvestigacion --> Participacion
Participacion --> EstadoParticipacion

' Director gestiona Personal
Director --> PersonalDeInvestigacion
Director ..> InformeActividades

' Herencia Personal
Ayudante --|> PersonalDeInvestigacion
Tecnico --|> PersonalDeInvestigacion
Asistente --|> PersonalDeInvestigacion

' Jefatura y Notificaciones
Notificacion <-- Director
Jefatura --> Proyecto
Jefatura --> Notificacion
' Jefatura revisa informes
Proyecto --> EstadoProyecto
PersonalDeInvestigacion --> Proyecto

InformeActividades --> SemanaActividades

@enduml