@startuml Sistema de Gestión de Personal De Investigación - Actualizado

skinparam classAttributeIconSize 0

package "Logica.Entidades" {

    class Jefatura {
        - nombres
        - apellidos
        - correo
        - cedula

        + registrarProyecto()
        + actualizarEstadoProyecto()
        + revisarReportes()
        + aprobarReportes()
        + revisarInformesDeActividades()
    }

    class Director {
        - nombres: String
        - apellidos: String
        - cedula: String
        - correo: String

        + visualizarSeguimiento()
        + registrarParticipacion()
        + gestionarSeguimiento()
        + actualizarContraseña()
        + registrarPersonalDeInvestigacion()
        + iniciarReporte()
        + editarReporte()
        + cerrarReporte()
        + enviarReporte()
        + aprobarInformeDeActividades()
        + revisarInformesDeActividades()
    }

    abstract class PersonalDeInvestigacion {
        - cedula: String
        - nombres: String
        - apellidos: String
        - correo: String

        + iniciarInformeActividades()
        + editarInformeActividades()
        + cerrarInformeActividades()
    }

    abstract class Proyecto {
        - codigo: String
        - nombre: String
        - periodoInicio: PeriodoAcademico
        - duracionSemestres: int
        - estado: EstadoProyecto
        - director: Director
        - numAsistentesPlanificados: int
        - numAyudantesPlanificados: int
        - numTecnicosPlanificados: int
        --
        + getTotalPersonalPlanificado(): int
        + cambiarEstado(EstadoProyecto): void
        + esEnEjecucion(): boolean
        + tieneIntegrantesPlanificados(): boolean
    }

    class ProyectoSemilla {
        - tipoProyecto: String
    }

    class ProyectoInterno {
        - tipoProyecto: String
    }

    class Reporte {
        - numeroReporte: int
        - periodoAcademicoId: String
        - proyecto: Proyecto
        - estado: EstadoReporte
        - fechaCreacion: LocalDateTime
        - fechaCierre: LocalDateTime

        + agregarParticipacion()
        + cerrar()
        + estaCompleto()
        + estaCerrado()
        + estaEnEdicion()
        + puedeEditarse()
    }

    class PeriodoAcademico {
        - codigo: String
        - fechaInicio: LocalDate
        - fechaFin: LocalDate
        - fechaMitad: LocalDate
        --
        + diasRestantes(): int
    }

    class Participacion {
        - id: int
        - personalDeInvestigacion: PersonalDeInvestigacion
        - fechaInicio: LocalDate
        - fechaFin: LocalDate
        - fechaRetiro: LocalDate
        - motivoRetiro: String
        - estado: EstadoParticipacion

        + esActivo(): boolean
        + registrarRetiro(String): void
        + estaRetirado(): boolean
        + haFinalizado(): boolean
        + calcularDuracion(): int
    }

    class InformeActividad {
        - id: int
        - fechaRegistro: LocalDate
        - descripcionActividades: String
        - horaEntrada: int
        - horaSalida: int
        - estado: EstadoInforme
        --
        + registrarActividades(String): void
        + enviarParaRevision(): void
        + aprobar(): void
        + rechazar(String motivo): void
    }

    class ResumenSeguimiento {
        - cantidadAsistentesPlanificados: int
        - cantidadAsistentesRegistrados: int
        - cantidadAsistentesActivos: int
        - cantidadAsistentesRetirados: int
        - totalPlanificado: int
        - totalRegistrado: int
        - cumplePlanificacionGlobal: boolean
        --
        + calcularTotales(): void
        + verificarCumplimiento(): boolean
    }

    class Notificacion {
        - id: int
        - destinatario: Director
        - fechaEnvio: LocalDateTime
        - contenido: String
        --
        + enviar(): void
    }

    class Asistente {}
    class Ayudante {
        - carrera: String
        - nivelSemestre: Integer
    }
    class Tecnico {}

    enum EstadoProyecto {
        EN_REVISION
        APROBADO
        NO_APROBADO
        FINALIZADO
    }

    enum EstadoReporte {
        EN_EDICION
        CERRADO
        APROBADO
    }

    enum EstadoParticipacion {
        ACTIVO
        RETIRADO
        FINALIZADO
    }



}

' ============================================
' RELACIONES ENTRE ENTIDADES
' ============================================

' Proyecto y Director
Director --> Proyecto
Proyecto --> PeriodoAcademico

' Herencia Proyectos
ProyectoInterno --|> Proyecto
ProyectoSemilla --|> Proyecto

' Reporte
Proyecto --> Reporte
Reporte --> PeriodoAcademico
Reporte --> EstadoReporte
Reporte --> Participacion

' Resumen
Proyecto --> ResumenSeguimiento

' [NUEVO] Relacion Participacion -> Informe
' Una Participacion tiene muchos informes de actividades
PersonalDeInvestigacion --> InformeActividad
InformeActividad --> EstadoReporte

' Personal y Participacion
PersonalDeInvestigacion --> Participacion
Participacion --> EstadoParticipacion

' Director gestiona Personal
Director --> PersonalDeInvestigacion
Director ..> InformeActividad

' Herencia Personal
Ayudante --|> PersonalDeInvestigacion
Tecnico --|> PersonalDeInvestigacion
Asistente --|> PersonalDeInvestigacion

' Jefatura y Notificaciones
Notificacion <-- Director
Jefatura --> Proyecto
Jefatura --> Notificacion
' Jefatura revisa informes
Proyecto --> EstadoProyecto
PersonalDeInvestigacion --> Proyecto

@enduml